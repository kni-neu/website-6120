<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>homework 7 | Natural Language Processing  CS 6120</title>
    <meta name="author" content="Natural Language Processing  CS 6120">
    <meta name="description" content="attention neural networks">
    <meta name="keywords" content="nlp, ai, ml, natural-language, Northeastern, Computer Science, CS6120">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;">
    
    <link rel="stylesheet" href="/cs6120f25/assets/css/main.css">
    <link rel="canonical" href="https://course.ccs.neu.edu//cs6120f25/homework-7/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">

    <script src="/cs6120f25/assets/js/theme.js"></script>
    <script src="/cs6120f25/assets/js/dark_mode.js"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/cs6120f25/"><span class="font-weight-bold">Natural Language Processing </span>CS 6120</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/cs6120f25/">home</a>
              </li>
              

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/cs6120f25/syllabus/">syllabus</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/cs6120f25/submissions/">submissions</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/cs6120f25/readings/">readings</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/cs6120f25/staff/">personnel</a>
              </li>
              <li class="nav-item dropdown ">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">previous classes</a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item" href="https://course.ccs.neu.edu/cs6120s25">spring 2025 (last semester)</a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="https://course.ccs.neu.edu/cs6120f25">fall 2025 (this semester)</a>
                </div>
              </li>

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container mt-5">
      <!-- page.html -->
        <div class="post">

          <header class="post-header">
            <h1 class="post-title">homework 7
		<!-- Added a PDF to the header -->
		
		   <a href="/cs6120f25/assets/pdf/assignment-7.pdf" target="_blank" rel="noopener noreferrer" class="float-right">
			   <i class="fas fa-file-pdf"></i></a>
	    </h1>
            <p class="post-description">attention neural networks</p>
          </header>

          <article>
            <hr style="border:2px solid gray">

<h4 id="attention-and-the-transformer">attention and the transformer</h4>
<hr>

<p>Summarization is an important task in natural language processing and could be useful for a consumer enterprise. For example, bots can be used to scrape articles, summarize them, and then you can use sentiment analysis to identify the sentiment about certain stocks. By completing this assignment you will learn to:</p>

<ul>
  <li>Use built-in functions to preprocess your data</li>
  <li>Implement DotProductAttention</li>
  <li>Implement Causal Attention</li>
  <li>Understand how attention works</li>
  <li>Build the transformer model</li>
  <li>Evaluate your model</li>
  <li>Summarize an article</li>
</ul>

<p>This model is slightly different than the ones you have already implemented. This is heavily based on attention and does not rely on sequences, which allows for parallel computing.</p>

<center>
<img src="https://deadline.com/wp-content/uploads/2024/09/Transformers-One.jpg" width="750" height="auto">
</center>
<p><br></p>

<hr>
<h4 id="data-and-starter-kits">data and starter kits</h4>
<hr>

<p>The python code you will need to modify and turn in is located <a href="/cs6120f25/assets/python/assignment7.py">here</a>. There are several functions that you will be modifying. They will be of the form</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">some_function</span><span class="p">(</span><span class="n">argument</span><span class="p">):</span>
    <span class="sh">'''</span><span class="s">Description of arguments and return values
    </span><span class="sh">'''</span>
    <span class="c1">### START CODE HERE ###
</span>
    <span class="n">return_values</span> <span class="o">=</span> <span class="sh">"</span><span class="s">This is where you will add or edit the code</span><span class="sh">"</span>

    <span class="c1">### END CODE HERE ###
</span>    <span class="k">return</span> <span class="n">return_values</span>
</code></pre></div></div>

<p>You will need to edit between <code class="language-plaintext highlighter-rouge">START CODE HERE</code> and <code class="language-plaintext highlighter-rouge">END CODE HERE</code>.</p>

<p>In addition, you will need the data. There are a variety of ways you can download them onto your workstations. On <a href="https://console.cloud.google.com/compute/instances" rel="external nofollow noopener" target="_blank">GCP VMs</a>, you can download with the bash command <code class="language-plaintext highlighter-rouge">wget</code>. If you wish to download inside of a notebook, you can type in a shell command by prepending each of the following commands with <code class="language-plaintext highlighter-rouge">!</code>. The full package can be downloaded with</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  wget <span class="nt">-nc</span> https://course.ccs.neu.edu/cs6120s25/assets/python/assignment7.py
  wget <span class="nt">-nc</span> https://course.ccs.neu.edu/cs6120s25/data/samsum/utils.py
  wget <span class="nt">-nc</span> https://course.ccs.neu.edu/cs6120s25/assets/python/assignment7_unittests.py
  wget <span class="nt">-nc</span> https://course.ccs.neu.edu/cs6120s25/data/samsum/corpus.tar
  <span class="nb">tar</span> <span class="nt">-xvf</span> corpus.tar
  pip <span class="nb">install </span>dlai_grader
</code></pre></div></div>

<p>This set of files contains:</p>

<ul>
  <li>
    <p><strong>Your Code Template</strong>: found in <a href="https://course.ccs.neu.edu/cs6120s25/assets/python/assignment7.py"><code class="language-plaintext highlighter-rouge">assignment7.py</code></a>, which is as described above.</p>
  </li>
  <li>
    <p><strong>The SAMsum dataset</strong>: around 16k paired conversations with their human-generated summaries, and can be found <a href="https://course.ccs.neu.edu/cs6120s25/data/samsum/">here</a>. Both the samples and their annotations are created by linguists, reflecting real-life messenger conversations: varying style, formality, slang, emojis, and general language patterns.</p>
  </li>
  <li>
    <p><strong>Loading Scripts</strong> found in <a href="https://course.ccs.neu.edu/cs6120s25/data/samsum/utils.py"><code class="language-plaintext highlighter-rouge">utils.py</code></a>. The dataset has several functions that we will be using to process the data, including splitting training and test data from a folder name and preprocessing that data. We will be calling the majority of these utils functions from the <code class="language-plaintext highlighter-rouge">preprocess_data</code> function.</p>
  </li>
  <li>
    <p><strong>Unit Tests</strong> found in <a href="https://course.ccs.neu.edu/cs6120s25/assets/python/assignment7_unittests.py"><code class="language-plaintext highlighter-rouge">assignment7_unittests.py</code></a>. For every function that you’re required to implement in <a href="https://course.ccs.neu.edu/cs6120s25/assets/python/assignment7.py"><code class="language-plaintext highlighter-rouge">assignment7.py</code></a>, there is a corresponding <code class="language-plaintext highlighter-rouge">*_test()</code> function that does preliminary dimensionality checks, initial sanity checks, and some unit tests. This function calls out to the unit test file, which has additional parameter checks after tensorflow initialization. If you are using a different version of Tensorflow (than <code class="language-plaintext highlighter-rouge">v2.18.0</code>), then you may not necessarily get the same exact values, so you can either disregard the calls to <code class="language-plaintext highlighter-rouge">assignment7_unittest</code> or install <code class="language-plaintext highlighter-rouge">v2.18.0</code>.</p>
  </li>
</ul>

<p>Beyond the homework specific files, you can use the following resources. It is important to note that Transformers are compute heavy, and it is much easier to train if you’re on GPU  hardware when training. You won’t need to train until you’ve completely finished your Python coding, so you can save your Google credits until the end. There are a variety of ways that you can secure GPU’s. To set resources, here are some options:</p>

<ul>
  <li>
<a href="https://console.cloud.google.com/compute/" rel="external nofollow noopener" target="_blank">Google Cloud Platform VMs</a>: remember to shutdown / delete if using GPU’s</li>
  <li>
<a href="https://console.cloud.google.com/vertex-ai/workbench" rel="external nofollow noopener" target="_blank">Google Cloud Workbench JupyterLab</a>: remember to shutdown / delete if using GPU’s</li>
  <li>
<a href="https://colab.research.google.com/" rel="external nofollow noopener" target="_blank">Google Colabs</a>: remember to close your session if using the T4 GPU.</li>
</ul>

<p>For any of the options above, you may find more luck in securing GPUs using the more expensive <code class="language-plaintext highlighter-rouge">NVIDIA L4</code> GPU Type. (Just remember to shut it off right after usage). You can check whether or not CUDA and Tensorflow are appropriately installed with <code class="language-plaintext highlighter-rouge">nvidia-smi</code> and <code class="language-plaintext highlighter-rouge">tf.config.list_physical_devices('GPU')</code>. In Colabs, your only available option is the <code class="language-plaintext highlighter-rouge">T4</code> GPU. If you hang on to the <code class="language-plaintext highlighter-rouge">T4</code> for too long, though, Google may shut you out of your account for a while so make sure you close your session. On GPU’s, each iteration is around 20 seconds (except for the first iteration, which is 40 seconds). On CPU’s, each iteration is around 20 minutes.</p>

<p>Note: all the unit tests in the homework were conducted with <code class="language-plaintext highlighter-rouge">tensorflow version 2.18.0</code>. There are minor differences in the tensorflow versions. You can check your version with:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
<span class="n">tf</span><span class="p">.</span><span class="n">__version__</span>
</code></pre></div></div>

<p>You are free to <em>develop</em> in any environment (including <a href="https://console.cloud.google.com/compute/instances" rel="external nofollow noopener" target="_blank">virtual machines</a> and <a href="https://console.cloud.google.com/vertex-ai/workbench" rel="external nofollow noopener" target="_blank">notebooks</a>), but your submission must be a <code class="language-plaintext highlighter-rouge">*.py</code> file.</p>

<p><br>
<br></p>

<h4 id="submission-instructions">submission instructions</h4>

<p>Submit your Python solution in <a href="/cs6120f25/assets/python/assignment7.py"><strong>assignment7.py</strong></a> to <a href="http://gradescope.com" rel="external nofollow noopener" target="_blank">Gradescope</a>.</p>


          </article>

        </div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © 2025 Natural Language Processing  CS 6120. Northeastern University, San Jose Campus, <a href="http://karllab41.github.io" rel="external nofollow noopener" target="_blank">Karl Ni</a>.  Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme.
Last updated: October 28, 2025.
      </div>
    </footer>


    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/cs6120f25/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script defer src="/cs6120f25/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script defer src="/cs6120f25/assets/js/common.js"></script>
  <script defer src="/cs6120f25/assets/js/copy_code.js" type="text/javascript"></script>

    
  <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>
  <script async src="https://badge.dimensions.ai/badge.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  </body>
</html>
